2. Cryptocurrencies:
abuses and forensics
Digital Forensics and Cybercrime course
Prof. Zanero

Criminal usage of Bitcoin
● This is a short, simplified introduction to
Bitcoin related only to its usage in
cybercrime
● Bitcoin actually has a much wider use and
importance, illicit usage is a fraction of it
● Similarly, the technical concepts underlying
Bitcoin are simplified here, in order to
support the specific focus of the class.
● Students of “Cyber Risk” may wish to take
056269 - BLOCKCHAIN AND
CRYPTOASSETS if interested
2

Formal Definition
● BitCoin is an information technology breakthrough that define
and implement a secure, decentralized payment system and a
tool for the storage, verification and auditing of information,
including digital representations of values.
● The bitcoin protocol defines an overlay network over Internet
that mine bitcoins, each node manage a group of addresses
that holds coins, each address is a hashed image of an
underlying private-public pair of cryptographic keys and act as
a pseudonym of the coin’s holder.
● The nodes view of this common state is formed by a
BlockChain, a shared, append-only, trustable, ledger of all
coins transactions. The limits of distributed consensus defined
in the Byzantine Problem and CAP Theorem are solved using
the technique of proof-of-work.
3

Bitcoin Wallet
A Wallet is the software that allows to:
● Manage and store the public and private key for each of
your bitcoin addresses.
● Create and sign transactions (receive or spend BTC)
● Track the balance (log of all of your incoming and outgoing
transactions)

4

Bitcoin Address
The bitcoin public address is an alphanumeric string from 26 to 35
characters used to receive payments (unique identifier that links
transactions with sender and receiver)

Receive payments. Think of
it like the bank details you'd
give to a friend that allows
them to send you money.

Access the transaction’s
history in relation to this
public address
5

6

How do transactions work?
... -> Joe

Joe -> Alice

Alice -> Bob

7

Blocks and blockchain

Block: Transactions within a certain timeframe
Blockchain: The linked list of all the blocks. A
distributed ledger that contains all the
transactions that have ever taken place since
Bitcoin creation
8

Bitcoin Mining - 1
Miners compete to generate a new valid block
that solves a complex mathematical problem by
bruteforce: the solver is then rewarded a fixed
number of BTC.
Nodes validates transactions that occur on the
network:
1. Miners choose transactions to include in a new block.
2. Nodes verify all the transactions in the block
3. If everything is good, nodes relay the new block to other
nodes.

9

Bitcoin Mining - 2
● Miners must solve a complex mathematical
problem in order to find the next block.
● The protocol ensures that the difficulty of
finding the next block increases or
decreases in relation to the number of
miners competing against one another.
○ 1 block is added every 10 minutes

● PoW - Proof-of-Work

10

Acceptable Block of Transaction

hash: 0000000000000000229df077……...58518d49e3e693
header
prevBlockHash: 00000000000000007fe93b67.……...d6f38a
mrklRootHash: d891b6185b013c9f0bb7c0e4………65bbe6
time: 1397034462
nonce: 930336509

SHA-256

transactions
hash
input

hash
input

hash
input

hash
input

output

output

output

output

signature

signature

signature

signature

11

Visualization of a blockchain fork
event—before the fork

12

Visualization of a blockchain fork
event: simultaneous solution found

13

Visualization of a blockchain fork
event: Propagate, splitting

14

Visualization of a blockchain fork
event: a new block extends one fork

15

Visualization of a blockchain fork
event: the network converges

16

Few more blocks to decide

A transaction is confirmed when it
belongs to a block at least 6/7 blocks
away from the end of the chain.
The longer the path, the more
computation was expended building it.

17

BTC and BlackMarket

18

Pseudo-Anonymity
Any identity can have an arbitrary number of
anonymous addresses ⇒ transactions to
oneself are unidentifiable
PRuis1
PUuis1

PRuis2
PUuis2

PRuis3
PUuis3

PRuis4
PUuis4

PRuis5
PUuis5

PRuis6
PUuis6

PRuis7
PUuis7

PRuis8
PUuis8

PRuis9
PUuis9

PRuis10 PRuis11 PRuis12
PUuis10 PUuis11 PUuis12

PU, PR pair is not assigned by an authority but is
generated by its owner

19

However...
Transaction data is public, and publicly
analyzable

20

Correlation of addresses
● If a transaction has multiple inputs, very
likely that the inputs are all owned by the
same entity
● Shadow addresses used for change
○ Until 2013 a bug in the reference implementation
made it deterministic to figure out the shadow
address
○ If you have 2 outputs and one is new, that’s probably
the shadow address

●
21

Our research: BitIodine (2014)

Michele Spagnuolo, Federico Maggi, and Stefano Zanero
BitIodine: Extracting Intelligence from the Bitcoin Network
https://www.ifca.ai/fc14/papers/fc14_submission_11.pdf

22

Transaction graph

User graph

Output of the BitIodine classifier

25

Example: investigating Silk Road
● Silk Road was a dark web marketplace for…
stuff
● Ran by someone under the nickname
“Dread Pirate Roberts”
● On Oct. 1st 2013 Ross William Ulbricht was
indicted and subsequently convicted for
several crimes related to SR:
○ narcotics trafficking conspiracy
○ computer hacking conspiracy
○ money laundering conspiracy
26

How do you track someone in the
Matrix?
● Very sophisticated de-anonymization techniques
and quantum-enabled machine learning
● Use altoid as nickname on different
forums to advertise the Silk Road.
Then use it to hire developers using
your rossulbricht@gmail.com email

27

But how could we track some of the
Silk Road funds?
● Sign up to silk road
○ We actually didn’t, we are using details posted
publicly by a user

● Deposit a small amount
● Note deposit address
○ In our instance,
1Q6nyjSQ79AAw67xAGHgXxXHRj9erLLqhD

● Track the flow
● Problem: coins are mixed together by SR
(a typical protection mechanism) - in this
case with more than 25000 others
28

Hopping through the blockchain

29

Hopping through the blockchain

30

Hopping through the blockchain

31

Hopping through the blockchain

32

Let’s look at this address

According to our analysis, one of the addresses that moved most funds in 2012...

33

So that’s how we track money, eh?
● Very sophisticated de-anonymization techniques
and quantum-enabled ML
● Using altoid, post on BitcoinTalk a
piece of code containing an address
1LDNLreKJ6GawBHPgB5yfVLBERi8g3SbQS

34

And once again, blockchain hopping

35

Investigating ransomware payments

36

CryptoLocker first wave
● Hit the Internet around 5 PM UTC on 5 Sep
2013
● Encrypts victim’s documents with strong
encryption and demands a ransom in Bitcoin
for decrypting them, with a 72h deadline
● Ransoms 10 BTC ➡ 2 BTC ➡ 0.5 BTC ➡
0.3 BTC
● That’s a lot of money now, it was a few
thousands->hundreds euros back then
37

Track payments (vs infections)

38

Further challenges
● Some less used cryptocurrencies have
stronger anonymity than Bitcoin, e.g. Monero
● First relevant instance: Wannacry operators
used Shapeshift to turn their Bitcoin into
Monero
● Please refer to:
https://ramses2020.eu/wp-content/uploads/sites/3/2019/09/D
6.2-Altcoins-Alternatives-to-Bitcoin-and-their-increasing-pres
ence-in-Malware-related-Cybercrime.pdf

39

